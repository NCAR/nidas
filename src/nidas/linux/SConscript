# -*- python -*-

##  Copyright 2005,2006 UCAR, NCAR, All Rights Reserved

##
##  Import the build environment.
##
Import('env')

# Make a copy of the environment so that we can add $KERNELDIR/include
# to CPPPATH without effecting builds in other directories.
env = env.Clone()

arch = env['ARCH']

# Do we really need $KERNELDIR/include in CPPPATH? kmake doesn't need it.
# env.AppendUnique(CPPPATH = [env.subst("$KERNELDIR/include")] )

subdirs=Split("""
    arinc
    diamond
    filters
    irig
    lams
    mesa
    ncar_a2d
    serial
    viper
    usbtwod
    util
""")

##
## ARCH target for creating modules, library, and executables
##
Alias(arch,['build_%s' % dir for dir in subdirs])

for dir in subdirs:
    env.SConscript('%s/SConscript' % dir,
               variant_dir='build_%s' % dir,
               duplicate=1,exports={'env':env})

headers = Split("""
    a2d.h
    isa_bus.h
    irigclock.h
    klog.h
    mesa.h
    ncar_a2d.h
    types.h
    util.h
    #/nidas/linux/SvnInfo.h
""")

env.Install('$PREFIX/include/nidas/linux', headers)
