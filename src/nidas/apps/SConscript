# -*- python -*-

##  Copyright 2005 UCAR, NCAR, All Rights Reserved

##
##  Import the cross-build environment.
##
Import('env')
myenv = env.Copy()
arch = myenv['ARCH']

# -D__cpluscplus   -fno-common  -fno-builtin

## myenv.AppendUnique(CPPPATH = Split("""
##       #dsm/class
##       #dsm/modules
##     """))

myenv.AppendUnique(LIBS = Split("""
    nidas
    nidas_dynld
    xerces-c
    pthread
    dl
    XmlRpc
    """))

if arch == 'arm':
    archapps=Split("""
        ck_dout.cc
    """)
else:
    archapps=Split("""
    """)


# ck_lams.cc
apps = Split("""
    ck_lams.cc
    ck_aout.cc
    ck_arinc.cc
    ck_calfile.cc
    merge_verify.cc
    nidsmerge.cc
    dsm_server.cc
    dsm.cc
    statsproc.cc
    serial_test.cc
    sensor_sim.cc
    ck_serial.cc
    ck_config.cc
    ck_goes.cc
    ck_selector.cc
    sample_test.cc
    data_stats.cc
    data_dump.cc
    sync_dump.cc
    sync_server.cc
    status_listener.cc
    rserial.cc
    psi9116_sim.cc
    cat_nids.cc
    ck_a2d.cc
    gps_nmea_sysclock.cc
    garmin.cc
    ck_xml.cc
    tee_tty.cc
    set_pcmcom8.c
    isff/pdecode.cc
    isff/prep.cc
    raf/cvi_lv_test_in.cc
    raf/cvi_lv_test_out.cc
    utime.cc
    proj_configs.cc
    n_hdr_util.cc
    sensor_extract.cc
""")

nodes = []
for i in apps + archapps:
    nodes += myenv.Program( i )

# suppress linking against nidas libraries
nodes += myenv.Program(target="isff/set_emerald",source="isff/set_emerald.c",LIBS=[])

myenv.Install('$PREFIX/bin',nodes)
